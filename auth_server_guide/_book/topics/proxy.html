<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Keycloak Security Proxy | Keycloak Reference Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../topics/custom-attributes.html" />
    
    
    <link rel="prev" href="../topics/application-clustering.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="31"
        data-chapter-title="Keycloak Security Proxy"
        data-filepath="topics/proxy.adoc"
        data-basepath=".."
        data-revision="Wed Apr 06 2016 12:47:24 GMT+0530 (IST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="topics/preface.html">
            
                
                    <a href="../topics/preface.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Preface
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="topics/Overview.html">
            
                
                    <a href="../topics/Overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Overview
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="topics/overview_key_concepts.html">
            
                
                    <a href="../topics/overview_key_concepts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Key Concepts in Keycloak
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="topics/overview_How_Security_Work_in_Keycloak.html">
            
                
                    <a href="../topics/overview_How_Security_Work_in_Keycloak.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        How Security Work in Keycloak?
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="topics/overview_permission_scopes.html">
            
                
                    <a href="../topics/overview_permission_scopes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                        Permission Scopes
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="topics/server-installation.html">
            
                
                    <a href="../topics/server-installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Installation and Configuration of Keycloak Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="topics/providers.html">
            
                
                    <a href="../topics/providers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Providers and SPIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="topics/openshift.html">
            
                
                    <a href="../topics/openshift.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Running Keycloak Server on OpenShift
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="topics/admin-permissions.html">
            
                
                    <a href="../topics/admin-permissions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Master Admin Access Control
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="topics/per-realm-admin-permissions.html">
            
                
                    <a href="../topics/per-realm-admin-permissions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Per Realm Admin Access Control
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="topics/adapter-config.html">
            
                
                    <a href="../topics/adapter-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Adapters
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="topics/jboss-adapter.html">
            
                
                    <a href="../topics/jboss-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        JBoss/Wildfly Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="topics/tomcat-adapter.html">
            
                
                    <a href="../topics/tomcat-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Tomcat 6, 7 and 8 Adapters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="topics/jetty9-adapter.html">
            
                
                    <a href="../topics/jetty9-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Jetty 9.x Adapters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="topics/jetty8-adapter.html">
            
                
                    <a href="../topics/jetty8-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Jetty 8.1.x Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="topics/servlet-filter-adapter.html">
            
                
                    <a href="../topics/servlet-filter-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Java Servlet Filter Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="topics/fuse-adapter.html">
            
                
                    <a href="../topics/fuse-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        JBoss Fuse and Apache Karaf Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="topics/javascript-adapter.html">
            
                
                    <a href="../topics/javascript-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        Javascript Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.8" data-path="topics/spring-boot-adapter.html">
            
                
                    <a href="../topics/spring-boot-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.8.</b>
                        
                        Spring Boot Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.9" data-path="topics/spring-security-adapter.html">
            
                
                    <a href="../topics/spring-security-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.9.</b>
                        
                        Spring Security Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.10" data-path="topics/installed-applications.html">
            
                
                    <a href="../topics/installed-applications.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.10.</b>
                        
                        Installed Applications
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.11" data-path="topics/logout.html">
            
                
                    <a href="../topics/logout.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.11.</b>
                        
                        Logout
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.12" data-path="topics/adapter_error_handling.html">
            
                
                    <a href="../topics/adapter_error_handling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.12.</b>
                        
                        Error Handling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.13" data-path="topics/multi-tenancy.html">
            
                
                    <a href="../topics/multi-tenancy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.13.</b>
                        
                        Multi Tenancy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.14" data-path="topics/jaas.html">
            
                
                    <a href="../topics/jaas.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.14.</b>
                        
                        JAAS plugin
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="topics/client-registration.html">
            
                
                    <a href="../topics/client-registration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Client Registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="topics/identity-broker.html">
            
                
                    <a href="../topics/identity-broker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Identity Broker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="topics/themes.html">
            
                
                    <a href="../topics/themes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Themes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="topics/recaptcha.html">
            
                
                    <a href="../topics/recaptcha.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Recaptcha Support on Registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="topics/email.html">
            
                
                    <a href="../topics/email.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Email
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="topics/access-types.html">
            
                
                    <a href="../topics/access-types.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        Client Access Types
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="topics/roles.html">
            
                
                    <a href="../topics/roles.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        Roles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="topics/groups.html">
            
                
                    <a href="../topics/groups.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        Groups
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="topics/direct-access.html">
            
                
                    <a href="../topics/direct-access.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        Direct Access Grants
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="topics/service-accounts.html">
            
                
                    <a href="../topics/service-accounts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        Service Accounts
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="topics/cors.html">
            
                
                    <a href="../topics/cors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        CORS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="topics/timeouts.html">
            
                
                    <a href="../topics/timeouts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        Cookie settings, Session Timeouts, and Token Lifespans
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="topics/admin-rest-api.html">
            
                
                    <a href="../topics/admin-rest-api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        Admin REST API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="topics/events.html">
            
                
                    <a href="../topics/events.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        Events
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="topics/user-federation.html">
            
                
                    <a href="../topics/user-federation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        User Federation SPI and LDAP/AD Integration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="topics/kerberos.html">
            
                
                    <a href="../topics/kerberos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        Kerberos brokering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="topics/export-import.html">
            
                
                    <a href="../topics/export-import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        Export and Import
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="topics/cache.html">
            
                
                    <a href="../topics/cache.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        Server Cache
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="topics/saml.html">
            
                
                    <a href="../topics/saml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        SAML SSO
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="topics/security-vulnerabilities.html">
            
                
                    <a href="../topics/security-vulnerabilities.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        Security Vulnerabilities
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="topics/clustering.html">
            
                
                    <a href="../topics/clustering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        Clustering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="topics/application-clustering.html">
            
                
                    <a href="../topics/application-clustering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        Application Clustering
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="31" data-path="topics/proxy.html">
            
                
                    <a href="../topics/proxy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        Keycloak Security Proxy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="topics/custom-attributes.html">
            
                
                    <a href="../topics/custom-attributes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        Custom User Attributes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="topics/protocol-mappers.html">
            
                
                    <a href="../topics/protocol-mappers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        OIDC Token and SAML Assertion Mappings
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="topics/auth-spi.html">
            
                
                    <a href="../topics/auth-spi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        Custom Authentication, Registration, and Required Actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="topics/MigrationFromOlderVersions.html">
            
                
                    <a href="../topics/MigrationFromOlderVersions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        Migration from older versions
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Keycloak Reference Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="_proxy">Keycloak Security Proxy</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Keycloak has an HTTP(S) proxy that you can put in front of web applications and services where it is not possible to install the keycloak adapter.
You can set up URL filters so that certain URLs are secured either by browser login and/or bearer token authentication.
You can also define role constraints for URL patterns within your applications.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_proxy_install_and_run">Proxy Install and Run</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Download the keycloak proxy distribution from the Keycloak download pages and unzip it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ unzip keycloak-proxy-dist.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>To run it you must have a proxy config file (which we&#x2019;ll discuss in a moment).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ java -jar bin/launcher.jar [your-config.json]</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do not specify a path to the proxy config file, the launcher will look in the current working directory for the file named <code>proxy.json</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_proxy_configuration">Proxy Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here&#x2019;s an example configuration file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    &quot;target-url&quot;: &quot;http://localhost:8082&quot;,
    &quot;send-access-token&quot;: true,
    &quot;bind-address&quot;: &quot;localhost&quot;,
    &quot;http-port&quot;: &quot;8080&quot;,
    &quot;https-port&quot;: &quot;8443&quot;,
    &quot;keystore&quot;: &quot;classpath:ssl.jks&quot;,
    &quot;keystore-password&quot;: &quot;password&quot;,
    &quot;key-password&quot;: &quot;password&quot;,
    &quot;applications&quot;: [
        {
            &quot;base-path&quot;: &quot;/customer-portal&quot;,
            &quot;error-page&quot;: &quot;/error.html&quot;,
            &quot;adapter-config&quot;: {
                &quot;realm&quot;: &quot;demo&quot;,
                &quot;resource&quot;: &quot;customer-portal&quot;,
                &quot;realm-public-key&quot;: &quot;MIGfMA0GCSqGSIb&quot;,
                &quot;auth-server-url&quot;: &quot;http://localhost:8081/auth&quot;,
                &quot;ssl-required&quot; : &quot;external&quot;,
                &quot;principal-attribute&quot;: &quot;name&quot;,
                &quot;credentials&quot;: {
                    &quot;secret&quot;: &quot;password&quot;
                }
            }
            ,
            &quot;constraints&quot;: [
                {
                    &quot;pattern&quot;: &quot;/users/*&quot;,
                    &quot;roles-allowed&quot;: [
                        &quot;user&quot;
                    ]
                },
                {
                    &quot;pattern&quot;: &quot;/admins/*&quot;,
                    &quot;roles-allowed&quot;: [
                        &quot;admin&quot;
                    ]
                },
                {
                    &quot;pattern&quot;: &quot;/users/permit&quot;,
                    &quot;permit&quot;: true
                },
                {
                    &quot;pattern&quot;: &quot;/users/deny&quot;,
                    &quot;deny&quot;: true
                }
            ]
        }
    ]
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_basic_config">Basic Config</h3>
<div class="paragraph">
<p>The basic configuration options for the server are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">target-url</dt>
<dd>
<p>The URL this server is proxying <em>REQUIRED.</em>.</p>
</dd>
<dt class="hdlist1">send-access-token</dt>
<dd>
<p>Boolean flag.
If true, this will send the access token via the KEYCLOAK_ACCESS_TOKEN header to the proxied server. <em>OPTIONAL.</em>.
Default is false.</p>
</dd>
<dt class="hdlist1">bind-address</dt>
<dd>
<p>DNS name or IP address to bind the proxy server&#x2019;s sockets to. <em>OPTIONAL.</em>.
The default value is <em>localhost</em></p>
</dd>
<dt class="hdlist1">http-port</dt>
<dd>
<p>Port to listen for HTTP requests.
If you do not specify this value, then the proxy will not listen for regular HTTP requests. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">https-port</dt>
<dd>
<p>Port to listen for HTTPS requests.
If you do not specify this value, then the proxy will not listen for HTTPS requests. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">keystore</dt>
<dd>
<p>Path to a Java keystore file that contains private key and certificate for the server to be able to handle HTTPS requests.
Can be a file path, or, if you prefix it with <code>classpath:</code>                            it will look for this file in the classpath. <em>OPTIONAL.</em>.
If you have enabled HTTPS, but have not defined a keystore, the proxy will auto-generate a self-signed certificate and use that.</p>
</dd>
<dt class="hdlist1">buffer-size</dt>
<dd>
<p>HTTP server socket buffer size.
Usually the default is good enough. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">buffers-per-region</dt>
<dd>
<p>HTTP server socket buffers per region.
Usually the default is good enough. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">io-threads</dt>
<dd>
<p>Number of threads to handle IO.
Usually default is good enough.
 <em>OPTIONAL.</em>.
The default is the number of available processors * 2.</p>
</dd>
<dt class="hdlist1">worker-threads</dt>
<dd>
<p>Number of threads to handle requests.
Usually the default is good enough. <em>OPTIONAL.</em>.
The default is the number of available processors * 16.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_application_config">Application Config</h3>
<div class="paragraph">
<p>Next under the <code>applications</code> array attribute, you can define one or more applications per host you are proxying.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">base-path</dt>
<dd>
<p>The base context root for the application.
Must start with &apos;/&apos; <em>REQUIRED.</em>.</p>
</dd>
<dt class="hdlist1">error-page</dt>
<dd>
<p>If the proxy has an error, it will display the target application&#x2019;s error page relative URL <em>OPTIONAL.</em>.
This is a relative path to the base-path.
In the example above it would be <code>/customer-portal/error.html</code>.</p>
</dd>
<dt class="hdlist1">adapter-config</dt>
<dd>
<p><em>REQUIRED.</em>.
Same configuration as any other keycloak adapter.
See <a href="#_adapter_config">Adapter Config</a></p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="_constraint_config">Constraint Config</h4>
<div class="paragraph">
<p>Next under each application you can define one or more constraints in the <code>constraints</code> array attribute.
A constraint defines a URL pattern relative to the base-path.
You can deny, permit, or require authentication for a specific URL pattern.
You can specify roles allowed for that path as well.
More specific constraints will take precedence over more general ones.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">pattern</dt>
<dd>
<p>URL pattern to match relative to the base-path of the application.
Must start with &apos;/&apos; <em>REQUIRED.</em>.
You may only have one wildcard and it must come at the end of the pattern.
Valid <code>/foo/bar/</code> and  <code>/foo/.txt</code>                                    Not valid: <code>//foo/</code>.</p>
</dd>
<dt class="hdlist1">roles-allowed</dt>
<dd>
<p>Array of strings of roles allowed to access this url pattern. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">methods</dt>
<dd>
<p>Array of strings of HTTP methods that will exclusively match this pattern and HTTP request. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">excluded-methods</dt>
<dd>
<p>Array of strings of HTTP methods that will be ignored when match this pattern. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">deny</dt>
<dd>
<p>Deny all access to this URL pattern. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">permit</dt>
<dd>
<p>Permit all access without requiring authentication or a role mapping. <em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">permit-and-inject</dt>
<dd>
<p>Permit all access, but inject the headers, if user is already authenticated.<em>OPTIONAL.</em>.</p>
</dd>
<dt class="hdlist1">authenticate</dt>
<dd>
<p>Require authentication for this pattern, but no role mapping. <em>OPTIONAL.</em>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_header_names_config">Header Names Config</h3>
<div class="paragraph">
<p>Next under the list of applications you can override the defaults for the names of the header fields injected by the proxy (see Keycloak Identity Headers). This mapping is optional.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">keycloak-subject</dt>
<dd>
<p>e.g.
MYAPP_USER_ID</p>
</dd>
<dt class="hdlist1">keycloak-username</dt>
<dd>
<p>e.g.
MYAPP_USER_NAME</p>
</dd>
<dt class="hdlist1">keycloak-email</dt>
<dd>
<p>e.g.
MYAPP_USER_EMAIL</p>
</dd>
<dt class="hdlist1">keycloak-name</dt>
<dd>
<p>e.g.
MYAPP_USER_ID</p>
</dd>
<dt class="hdlist1">keycloak-access-token</dt>
<dd>
<p>e.g.
MYAPP_ACCESS_TOKEN</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keycloak_identity_headers">Keycloak Identity Headers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When forwarding requests to the proxied server, Keycloak Proxy will set some additional headers with values from the OIDC identity token it received for authentication.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">KEYCLOAK_SUBJECT</dt>
<dd>
<p>User id.
Corresponds to JWT <code>sub</code> and will be the user id Keycloak uses to store this user.</p>
</dd>
<dt class="hdlist1">KEYCLOAK_USERNAME</dt>
<dd>
<p>Username.
Corresponds to JWT <code>preferred_username</code></p>
</dd>
<dt class="hdlist1">KEYCLOAK_EMAIL</dt>
<dd>
<p>Email address of user if set.</p>
</dd>
<dt class="hdlist1">KEYCLOAK_NAME</dt>
<dd>
<p>Full name of user if set.</p>
</dd>
<dt class="hdlist1">KEYCLOAK_ACCESS_TOKEN</dt>
<dd>
<p>Send the access token in this header if the proxy was configured to send it.
This token can be used to make bearer token requests.             Header field names can be configured using a map of <code>header-names</code> in configuration file:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    &quot;header-names&quot; {
        &quot;keycloak-subject&quot;: &quot;MY_SUBJECT&quot;
    }
}</code></pre>
</div>
</div>
</div>
</div>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../topics/application-clustering.html" class="navigation navigation-prev " aria-label="Previous page: Application Clustering"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../topics/custom-attributes.html" class="navigation navigation-next " aria-label="Next page: Custom User Attributes"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
