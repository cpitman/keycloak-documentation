<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Installation and Configuration of Keycloak Server | Keycloak</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../topics/providers.html" />
    
    
    <link rel="prev" href="../topics/Overview.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="3"
        data-chapter-title="Installation and Configuration of Keycloak Server"
        data-filepath="topics/server-installation.adoc"
        data-basepath=".."
        data-revision="Tue Apr 05 2016 21:38:08 GMT+0530 (IST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="topics/preface.html">
            
            <span><b>1.</b> Overview</span>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="topics/Overview.html">
            
                
                    <a href="../topics/Overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="3" data-path="topics/server-installation.html">
            
                
                    <a href="../topics/server-installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Installation and Configuration of Keycloak Server
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="topics/providers.html">
            
                
                    <a href="../topics/providers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Providers and SPIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="topics/openshift.html">
            
                
                    <a href="../topics/openshift.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Running Keycloak Server on OpenShift
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="topics/admin-permissions.html">
            
                
                    <a href="../topics/admin-permissions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Master Admin Access Control
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="topics/per-realm-admin-permissions.html">
            
                
                    <a href="../topics/per-realm-admin-permissions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Per Realm Admin Access Control
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="topics/adapter-config.html">
            
                
                    <a href="../topics/adapter-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        Adapters
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="topics/jboss-adapter.html">
            
                
                    <a href="../topics/jboss-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        JBoss/Wildfly Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="topics/tomcat-adapter.html">
            
                
                    <a href="../topics/tomcat-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Tomcat 6, 7 and 8 Adapters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="topics/jetty9-adapter.html">
            
                
                    <a href="../topics/jetty9-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Jetty 9.x Adapters
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="topics/jetty8-adapter.html">
            
                
                    <a href="../topics/jetty8-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Jetty 8.1.x Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="topics/servlet-filter-adapter.html">
            
                
                    <a href="../topics/servlet-filter-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Java Servlet Filter Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.6" data-path="topics/fuse-adapter.html">
            
                
                    <a href="../topics/fuse-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.6.</b>
                        
                        JBoss Fuse and Apache Karaf Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.7" data-path="topics/javascript-adapter.html">
            
                
                    <a href="../topics/javascript-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.7.</b>
                        
                        Javascript Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.8" data-path="topics/spring-boot-adapter.html">
            
                
                    <a href="../topics/spring-boot-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.8.</b>
                        
                        Spring Boot Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.9" data-path="topics/spring-security-adapter.html">
            
                
                    <a href="../topics/spring-security-adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.9.</b>
                        
                        Spring Security Adapter
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.10" data-path="topics/installed-applications.html">
            
                
                    <a href="../topics/installed-applications.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.10.</b>
                        
                        Installed Applications
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.11" data-path="topics/logout.html">
            
                
                    <a href="../topics/logout.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.11.</b>
                        
                        Logout
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.12" data-path="topics/adapter_error_handling.html">
            
                
                    <a href="../topics/adapter_error_handling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.12.</b>
                        
                        Error Handling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.13" data-path="topics/multi-tenancy.html">
            
                
                    <a href="../topics/multi-tenancy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.13.</b>
                        
                        Multi Tenancy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.14" data-path="topics/jaas.html">
            
                
                    <a href="../topics/jaas.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.14.</b>
                        
                        JAAS plugin
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="topics/client-registration.html">
            
                
                    <a href="../topics/client-registration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        Client Registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="topics/identity-broker.html">
            
                
                    <a href="../topics/identity-broker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Identity Broker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="topics/themes.html">
            
                
                    <a href="../topics/themes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        Themes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="topics/recaptcha.html">
            
                
                    <a href="../topics/recaptcha.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        Recaptcha Support on Registration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="topics/email.html">
            
                
                    <a href="../topics/email.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Email
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="topics/access-types.html">
            
                
                    <a href="../topics/access-types.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        Client Access Types
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="topics/roles.html">
            
                
                    <a href="../topics/roles.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        Roles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="topics/groups.html">
            
                
                    <a href="../topics/groups.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        Groups
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="topics/direct-access.html">
            
                
                    <a href="../topics/direct-access.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        Direct Access Grants
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="topics/service-accounts.html">
            
                
                    <a href="../topics/service-accounts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        Service Accounts
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="topics/cors.html">
            
                
                    <a href="../topics/cors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        CORS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="topics/timeouts.html">
            
                
                    <a href="../topics/timeouts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        Cookie settings, Session Timeouts, and Token Lifespans
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="topics/admin-rest-api.html">
            
                
                    <a href="../topics/admin-rest-api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        Admin REST API
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="topics/events.html">
            
                
                    <a href="../topics/events.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        Events
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="topics/user-federation.html">
            
                
                    <a href="../topics/user-federation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        User Federation SPI and LDAP/AD Integration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="topics/kerberos.html">
            
                
                    <a href="../topics/kerberos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        Kerberos brokering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="topics/export-import.html">
            
                
                    <a href="../topics/export-import.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        Export and Import
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="topics/cache.html">
            
                
                    <a href="../topics/cache.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        Server Cache
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="topics/saml.html">
            
                
                    <a href="../topics/saml.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        SAML SSO
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="topics/security-vulnerabilities.html">
            
                
                    <a href="../topics/security-vulnerabilities.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        Security Vulnerabilities
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="topics/clustering.html">
            
                
                    <a href="../topics/clustering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        Clustering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="topics/application-clustering.html">
            
                
                    <a href="../topics/application-clustering.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        Application Clustering
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="31" data-path="topics/proxy.html">
            
                
                    <a href="../topics/proxy.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        Keycloak Security Proxy
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="topics/custom-attributes.html">
            
                
                    <a href="../topics/custom-attributes.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        Custom User Attributes
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="topics/protocol-mappers.html">
            
                
                    <a href="../topics/protocol-mappers.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        OIDC Token and SAML Assertion Mappings
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="topics/auth-spi.html">
            
                
                    <a href="../topics/auth-spi.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        Custom Authentication, Registration, and Required Actions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="topics/MigrationFromOlderVersions.html">
            
                
                    <a href="../topics/MigrationFromOlderVersions.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        Migration from older versions
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Keycloak</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="_server_installation">Installation and Configuration of Keycloak Server</h1>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Keycloak Server has three downloadable distributions.
To run the Keycloak server you need to have Java 8 already installed.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>keycloak-.[zip|tar.gz]</p>
</li>
<li>
<p>keycloak-overlay-.[zip|tar.gz]</p>
</li>
<li>
<p>keycloak-demo-.[zip|tar.gz]</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_server_install">Install Standalone Server</h3>
<div class="paragraph">
<p>For production and for non-JavaEE developers we recommend using the standalone Keycloak server.
All you need to do is to download <code>keycloak-.zip</code> or  <code>keycloak-.tar.gz</code>, unpackage and start to have a Keycloak server up and running.</p>
</div>
<div class="paragraph">
<p>To install first download either the zip or tar.gz and extract.
Then start by running either:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>keycloak-/bin/standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>keycloak-/bin/standalone.bat</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_overlay_install">Install on existing WildFly or JBoss EAP</h3>
<div class="paragraph">
<p>Keycloak can be installed into an existing installations of WildFly  or JBoss EAP . To do this download <code>keycloak-overlay-.zip</code> or <code>keycloak-overlay-.tar.gz</code>.
Once downloaded extract into the root directory of your installation.</p>
</div>
<div class="paragraph">
<p>To add Keycloak to existing standalone.xml server config run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/jboss-cli.sh --file=bin/keycloak-install.cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>To add Keycloak to existing standalone-ha.xml server config run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/jboss-cli.sh --file=bin/keycloak-install-ha.cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to add Keycloak to a different server config edit <code>keycloak-install.cli</code> or <code>keycloak-install-ha.cli</code> and change the name of the server config.</p>
</div>
</div>
<div class="sect2">
<h3 id="_install_development_bundle">Install Development Bundle</h3>
<div class="paragraph">
<p>The demo bundle contains everything you need to get started with Keycloak including documentation and examples.
To install it first download <code>keycloak-demo-.zip</code> or <code>keycloak-demo-.tar.gz</code>.
Once downloaded extract it inside <code>keycloak-demo-</code> you&#x2019;ll find <code>keycloak</code> which contains a full WildFly  server with Keycloak Server and Adapters included.
You&#x2019;ll also find <code>docs</code> and <code>examples</code> which contains everything you need to get started developing applications that use Keycloak.</p>
</div>
<div class="paragraph">
<p>To start WildFly with Keycloak run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>keycloak-/bin/standalone.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>keycloak-/bin/standalone.bat</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuring_the_server">Configuring the Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although the Keycloak Server is designed to run out of the box, there&#x2019;s some things you&#x2019;ll need to configure before you go into production.
Specifically:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuring Keycloak to use a production database</p>
</li>
<li>
<p>Setting up SSL/HTTPS</p>
</li>
<li>
<p>Enforcing HTTPS connections</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_admin_user">Admin User</h3>
<div class="paragraph">
<p>To access the admin console to configure Keycloak you need an account to login.
There is no built in user, instead you have to first create an admin account.
This can done either by opening <a href="http://localhost:8080/auth" class="bare" target="_blank">http://localhost:8080/auth</a>                (creating a user through the browser can only be done through localhost) or you can use the add-user script from the command-line.</p>
</div>
<div class="paragraph">
<p>The <code>add-user</code> script creates a temporary file with the details of the user, which are imported at startup.
To add a user with this script run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/add-user.[sh|bat] -r master -u &lt;username&gt; -p &lt;password&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then restart the server.
For <code>keycloak-overlay</code>, please make sure to use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/add-user-keycloak.[sh|bat] -r master -u &lt;username&gt; -p &lt;password&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_relational_database_configuration">Relational Database Configuration</h3>
<div class="paragraph">
<p>You might want to use a better relational database for Keycloak like PostgreSQL or MySQL.
You might also want to tweak the configuration settings of the datasource.
Please see the <a href="https://docs.jboss.org/author/display/WFLY8/DataSource+configuration" target="_blank">Wildfly</a>                documentation on how to do this.</p>
</div>
<div class="paragraph">
<p>Keycloak runs on a Hibernate/JPA backend which is configured in the <code>standalone/configuration/keycloak-server.json</code>.
By default the setting is like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;connectionsJpa&quot;: {
    &quot;default&quot;: {
        &quot;dataSource&quot;: &quot;java:jboss/datasources/KeycloakDS&quot;,
        &quot;databaseSchema&quot;: &quot;update&quot;
    }
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Possible configuration options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dataSource</dt>
<dd>
<p>JNDI name of the dataSource</p>
</dd>
<dt class="hdlist1">jta</dt>
<dd>
<p>boolean property to specify if datasource is JTA capable</p>
</dd>
<dt class="hdlist1">driverDialect</dt>
<dd>
<p>Value of Hibernate dialect.
In most cases you don&#x2019;t need to specify this property as dialect will be autodetected by Hibernate.</p>
</dd>
<dt class="hdlist1">databaseSchema</dt>
<dd>
<p>Specify if schema should be updated or validated.
Valid values are &quot;update&quot; and &quot;validate&quot; (&quot;update is default).</p>
</dd>
<dt class="hdlist1">showSql</dt>
<dd>
<p>Specify whether Hibernate should show all SQL commands in the console (false by default)</p>
</dd>
<dt class="hdlist1">formatSql</dt>
<dd>
<p>Specify whether Hibernate should format SQL commands (true by default)</p>
</dd>
<dt class="hdlist1">globalStatsInterval</dt>
<dd>
<p>Will log global statistics from Hibernate about executed DB queries and other things.
Statistics are always reported to server log at specified interval (in seconds) and are cleared after each report.</p>
</dd>
<dt class="hdlist1">schema</dt>
<dd>
<p>Specify the database schema to use</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_tested_databases">Tested databases</h5>
<div class="paragraph">
<p>Here is list of RDBMS databases and corresponding JDBC drivers, which were tested with Keycloak.
Note that Hibernate dialect is usually set automatically according to your database, but you have possibility to override if default dialect doesn&#x2019;t work correctly.
You can setup dialect by adding property <code>driverDialect</code> to the <code>keycloak-server.json</code> into <code>connectionsJpa</code> section (see above).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Tested databases</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Database</th>
<th class="tableblock halign-left valign-top">JDBC driver</th>
<th class="tableblock halign-left valign-top">Hibernate Dialect</th>
</tr>
</thead>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_mongodb_based_model">MongoDB based model</h3>
<div class="paragraph">
<p>Keycloak provides <a href="http://www.mongodb.com" target="_blank">MongoDB</a> based model implementation, which means that your identity data will be saved in MongoDB instead of traditional RDBMS.
To configure Keycloak to use Mongo open <code>standalone/configuration/keycloak-server.json</code> in your favourite editor, then change:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;eventsStore&quot;: {
    &quot;provider&quot;: &quot;jpa&quot;,
    &quot;jpa&quot;: {
        &quot;exclude-events&quot;: [ &quot;REFRESH_TOKEN&quot; ]
    }
},

&quot;realm&quot;: {
    &quot;provider&quot;: &quot;jpa&quot;
},

&quot;user&quot;: {
    &quot;provider&quot;: &quot;${keycloak.user.provider:jpa}&quot;
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;eventsStore&quot;: {
    &quot;provider&quot;: &quot;mongo&quot;,
    &quot;mongo&quot;: {
        &quot;exclude-events&quot;: [ &quot;REFRESH_TOKEN&quot; ]
    }
},

&quot;realm&quot;: {
    &quot;provider&quot;: &quot;mongo&quot;
},

&quot;user&quot;: {
    &quot;provider&quot;: &quot;mongo&quot;
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>And at the end of the file add the snippet like this where you can configure details about your Mongo database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;connectionsMongo&quot;: {
    &quot;default&quot;: {
        &quot;host&quot;: &quot;127.0.0.1&quot;,
        &quot;port&quot;: &quot;27017&quot;,
        &quot;db&quot;: &quot;keycloak&quot;,
        &quot;connectionsPerHost&quot;: 100,
        &quot;databaseSchema&quot;: &quot;update&quot;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All configuration options are optional.
Default values for host and port are localhost and 27017.
Default name of database is <code>keycloak</code> . You can also specify properties <code>user</code> and <code>password</code> if you want authenticate against your MongoDB.
If user and password are not specified, Keycloak will connect unauthenticated to your MongoDB.</p>
</div>
<div class="paragraph">
<p>Finally there is set of optional configuration options, which can be used to specify connection-pooling capabilities of Mongo client.
Supported int options are: <code>connectionsPerHost</code>, <code>threadsAllowedToBlockForConnectionMultiplier</code>, <code>maxWaitTime</code>, <code>connectTimeout</code> <code>socketTimeout</code>.
Supported boolean options are: <code>socketKeepAlive</code>, <code>autoConnectRetry</code>.
Supported long option is <code>maxAutoConnectRetryTime</code>.
See <a href="http://api.mongodb.org/java/2.11.4/com/mongodb/MongoClientOptions.html" target="_blank">Mongo documentation</a>                for details about those options and their default values.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can configure MongoDB using a MongoDB <a href="http://docs.mongodb.org/manual/reference/connection-string/" target="_blank">connection URI</a>.
In this case, you define all information concerning the connection and authentication within the URI, as described in the MongoDB documentation.
Please note that the database specified within the URI is only used for authentication.
To change the database used by keycloak you have to set <code>db</code> property as before.
Therefore, a configuration like the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;connectionsMongo&quot;: {
    &quot;default&quot;: {
        &quot;uri&quot;: &quot;mongodb://user:password@127.0.0.1/authentication&quot;,
        &quot;db&quot;: &quot;keycloak&quot;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>will authenticate the user against the authentication database, but store all keycloak related data in the keycloak database.</p>
</div>
<div class="sect3">
<h4 id="_mongodb_replica_sets">MongoDB Replica Sets</h4>
<div class="paragraph">
<p>In order to use a mongo replica set for Keycloak, one has to use URI based configuration, which supports the definition of replica sets out of the box: <code>mongodb://host1:27017,host2:27017,host3:27017/</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_outgoing_server_http_requests">Outgoing Server HTTP Requests</h3>
<div class="paragraph">
<p>Keycloak server needs to invoke on remote HTTP endpoints to do things like backchannel logouts and other management functions.
Keycloak maintains a HTTP client connection pool which has various configuration settings you can specify before boot time.
This is configured in the <code>standalone/configuration/keycloak-server.json</code>.
By default the setting is like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;connectionsHttpClient&quot;: {
    &quot;default&quot;: {}
},</code></pre>
</div>
</div>
<div class="paragraph">
<p>Possible configuration options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">establish-connection-timeout-millis</dt>
<dd>
<p>Timeout for establishing a socket connection.</p>
</dd>
<dt class="hdlist1">socket-timeout-millis</dt>
<dd>
<p>If an outgoing request does not receive data for this amount of time, timeout the connection.</p>
</dd>
<dt class="hdlist1">connection-pool-size</dt>
<dd>
<p>How many connections can be in the pool (128 by default).</p>
</dd>
<dt class="hdlist1">max-pooled-per-route</dt>
<dd>
<p>How many connections can be pooled per host (64 by default).</p>
</dd>
<dt class="hdlist1">connection-ttl-millis</dt>
<dd>
<p>Maximum connection time to live in milliseconds.
Not set by default.</p>
</dd>
<dt class="hdlist1">max-connection-idle-time-millis</dt>
<dd>
<p>Maximum time the connection might stay idle in the connection pool (900 seconds by default). Will start background cleaner thread of Apache HTTP client.
Set to -1 to disable this checking and the background thread.</p>
</dd>
<dt class="hdlist1">disable-cookies</dt>
<dd>
<p><code>true</code> by default.
When set to true, this will disable any cookie caching.</p>
</dd>
<dt class="hdlist1">client-keystore</dt>
<dd>
<p>This is the file path to a Java keystore file.
This keystore contains client certificate for two-way SSL.</p>
</dd>
<dt class="hdlist1">client-keystore-password</dt>
<dd>
<p>Password for the client keystore.
This is <em>REQUIRED</em> if <code>client-keystore</code> is set.</p>
</dd>
<dt class="hdlist1">client-key-password</dt>
<dd>
<p><em>Not supported yet, but we will support in future versions. Password for the client&#x2019;s key.
This is _REQUIRED</em> if <code>client-keystore</code> is set.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_truststore">Securing Outgoing Server HTTP Requests</h3>
<div class="paragraph">
<p>When Keycloak connects out to remote HTTP endpoints over secure https connection, it has to validate the other server&#x2019;s certificate in order to ensure it is connecting to a trusted server.
That is necessary in order to prevent man-in-the-middle attacks.</p>
</div>
<div class="paragraph">
<p>How certificates are validated is configured in the <code>standalone/configuration/keycloak-server.json</code>.
By default truststore provider is not configured, and any https connections fall back to standard java truststore configuration as described in <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html" target="_blank">
            Java&#x2019;s JSSE Reference Guide</a> - using <code>javax.net.ssl.trustStore system property</code>, otherwise <code>cacerts</code> file that comes with java is used.</p>
</div>
<div class="paragraph">
<p>Truststore is used when connecting securely to identity brokers, LDAP identity providers, when sending emails, and for backchannel communication with client applications.
Some of these facilities may - in case when no trusted certificate is found in your configured truststore - fallback to using the JSSE provided truststore.
The default JavaMail API implementation used to send out emails behaves in this way, for example.</p>
</div>
<div class="paragraph">
<p>You can add your truststore configuration by using the following template:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&quot;truststore&quot;: {
    &quot;file&quot;: {
        &quot;file&quot;: &quot;path to your .jks file containing public certificates&quot;,
        &quot;password&quot;: &quot;password&quot;,
        &quot;hostname-verification-policy&quot;: &quot;WILDCARD&quot;,
        &quot;disabled&quot;: false
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Possible configuration options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">file</dt>
<dd>
<p>The value is the file path to a Java keystore file.
HTTPS requests need a way to verify the host of the server they are talking to.
This is what the trustore does.
The keystore contains one or more trusted host certificates or certificate authorities.
Truststore file should only contain public certificates of your secured hosts.
This is <em>REQUIRED</em> if <code>disabled</code> is not true.</p>
</dd>
<dt class="hdlist1">password</dt>
<dd>
<p>Password for the truststore.
This is <em>REQUIRED</em> if <code>disabled</code> is not true.</p>
</dd>
<dt class="hdlist1">hostname-verification-policy</dt>
<dd>
<p><code>WILDCARD</code> by default.
For HTTPS requests, this verifies the hostname of the server&#x2019;s certificate.
 <code>ANY</code> means that the hostname is not verified. <code>WILDCARD</code> Allows wildcards in subdomain names i.e.
*.foo.com. <code>STRICT</code> CN must match hostname exactly.</p>
</dd>
<dt class="hdlist1">disabled</dt>
<dd>
<p>If true (default value), truststore configuration will be ignored, and certificate checking will fall back to JSSE configuration as described.
If set to false, you must configure <code>file</code>, and <code>password</code> for the truststore.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can use <em>keytool</em> to create a new truststore file and add trusted host certificates to it:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ keytool -import -alias HOSTDOMAIN -keystore truststore.jks -file host-certificate.cer</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ssl_modes">SSL/HTTPS Requirement/Modes</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Keycloak is not set up by default to handle SSL/HTTPS.
It is highly recommended that you either enable SSL on the Keycloak server itself or on a reverse proxy in front of the Keycloak server.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Keycloak can run out of the box without SSL so long as you stick to private IP addresses like localhost, 127.0.0.1, 10.0.x.x, 192.168.x.x, and 172..16.x.x.
If you try to access Keycloak from a non-IP adress you will get an error.</p>
</div>
<div class="paragraph">
<p>Keycloak has 3 SSL/HTTPS modes which you can set up in the admin console under the Settings&#x2192;Login page and the <code>Require SSL</code> select box.
Each adapter config should mirror this server-side setting.
See adapter config section for more details.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">external</dt>
<dd>
<p>Keycloak can run out of the box without SSL so long as you stick to private IP addresses like localhost, 127.0.0.1, 10.0.x.x, 192.168.x.x, and 172..16.x.x.
If you try to access Keycloak from a non-IP adress you will get an error.</p>
</dd>
<dt class="hdlist1">none</dt>
<dd>
<p>Keycloak does not require SSL.</p>
</dd>
<dt class="hdlist1">all</dt>
<dd>
<p>Keycloak requires SSL for all IP addresses.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_ssl_https_setup">SSL/HTTPS Setup</h3>
<div class="paragraph">
<p>First enable SSL on Keycloak or on a reverse proxy in front of Keycloak.
Then configure the Keycloak Server to enforce HTTPS connections.</p>
</div>
<div class="sect3">
<h4 id="_enable_ssl_on_keycloak">Enable SSL on Keycloak</h4>
<div class="paragraph">
<p>The following things need to be done</p>
</div>
<div class="ulist">
<ul>
<li>
<p>keytool</p>
</li>
<li>
<p>Enable Wildfly to use this certificate and turn on SSL/HTTPS.</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="_creating_the_certificate_and_java_keystore">Creating the Certificate and Java Keystore</h5>
<div class="paragraph">
<p>In order to allow HTTPS connections, you need to obtain a self signed or third-party signed certificate and import it into a Java keystore before you can enable HTTPS in the web container you are deploying the Keycloak Server to.</p>
</div>
<div class="sect5">
<h6 id="_self_signed_certificate">Self Signed Certificate</h6>
<div class="paragraph">
<p>In development, you will probably not have a third party signed certificate available to test a Keycloak deployment so you&#x2019;ll need to generate a self-signed on.
Generate one is very easy to do with the <code>keytool</code> utility that comes with the Java jdk.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ keytool -genkey -alias localhost -keyalg RSA -keystore keycloak.jks -validity 10950
    Enter keystore password: secret
    Re-enter new password: secret
    What is your first and last name?
    [Unknown]:  localhost
    What is the name of your organizational unit?
    [Unknown]:  Keycloak
    What is the name of your organization?
    [Unknown]:  Red Hat
    What is the name of your City or Locality?
    [Unknown]:  Westford
    What is the name of your State or Province?
    [Unknown]:  MA
    What is the two-letter country code for this unit?
    [Unknown]:  US
    Is CN=localhost, OU=Keycloak, O=Test, L=Westford, ST=MA, C=US correct?
    [no]:  yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>You should answer <code>What is your first and last name ?</code> question with the DNS name of the machine you&#x2019;re installing the server on.
For testing purposes, <code>localhost</code> should be used.
After executing this command, the <code>keycloak.jks</code> file will be generated in the same directory as you executed the <code>keytool</code> command in.</p>
</div>
<div class="paragraph">
<p>If you want a third-party signed certificate, but don&#x2019;t have one, you can obtain one for free at <a href="http://cacert.org" target="_blank">cacert.org</a>.
You&#x2019;ll have to do a little set up first before doing this though.</p>
</div>
<div class="paragraph">
<p>The first thing to do is generate a Certificate Request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ keytool -certreq -alias yourdomain -keystore keycloak.jks &gt; keycloak.careq</code></pre>
</div>
</div>
<div class="paragraph">
<p>Where <code>yourdomain</code> is a DNS name for which this certificate is generated for.
Keytool generates the request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>-----BEGIN NEW CERTIFICATE REQUEST-----
MIIC2jCCAcICAQAwZTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk1BMREwDwYDVQQHEwhXZXN0Zm9y
ZDEQMA4GA1UEChMHUmVkIEhhdDEQMA4GA1UECxMHUmVkIEhhdDESMBAGA1UEAxMJbG9jYWxob3N0
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAr7kck2TaavlEOGbcpi9c0rncY4HhdzmY
Ax2nZfq1eZEaIPqI5aTxwQZzzLDK9qbeAd8Ji79HzSqnRDxNYaZu7mAYhFKHgixsolE3o5Yfzbw1
29Rvy+eUVe+WZxv5oo9wolVVpdSINIMEL2LaFhtX/c1dqiqYVpfnvFshZQaIg2nL8juzZcBjj4as
H98gIS7khql/dkZKsw9NLvyxgJvp7PaXurX29fNf3ihG+oFrL22oFyV54BWWxXCKU/GPn61EGZGw
Ft2qSIGLdctpMD1aJR2bcnlhEjZKDksjQZoQ5YMXaAGkcYkG6QkgrocDE2YXDbi7GIdf9MegVJ35
2DQMpwIDAQABoDAwLgYJKoZIhvcNAQkOMSEwHzAdBgNVHQ4EFgQUQwlZJBA+fjiDdiVzaO9vrE/i
n2swDQYJKoZIhvcNAQELBQADggEBAC5FRvMkhal3q86tHPBYWBuTtmcSjs4qUm6V6f63frhveWHf
PzRrI1xH272XUIeBk0gtzWo0nNZnf0mMCtUBbHhhDcG82xolikfqibZijoQZCiGiedVjHJFtniDQ
9bMDUOXEMQ7gHZg5q6mJfNG9MbMpQaUVEEFvfGEQQxbiFK7hRWU8S23/d80e8nExgQxdJWJ6vd0X
MzzFK6j4Dj55bJVuM7GFmfdNC52pNOD5vYe47Aqh8oajHX9XTycVtPXl45rrWAH33ftbrS8SrZ2S
vqIFQeuLL3BaHwpl3t7j2lMWcK1p80laAxEASib/fAwrRHpLHBXRcq6uALUOZl4Alt8=
-----END NEW CERTIFICATE REQUEST-----</code></pre>
</div>
</div>
<div class="paragraph">
<p>Send this ca request to your CA.
The CA will issue you a signed certificate and send it to you.
Before you import your new cert, you must obtain and import the root certificate of the CA.
You can download the cert from CA (ie.: root.crt) and import as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ keytool -import -keystore keycloak.jks -file root.crt -alias root</code></pre>
</div>
</div>
<div class="paragraph">
<p>Last step is import your new CA generated certificate to your keystore:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ keytool -import -alias yourdomain -keystore keycloak.jks -file your-certificate.cer</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_installing_the_keystore_to_wildfly">Installing the keystore to WildFly</h5>
<div class="paragraph">
<p>Now that you have a Java keystore with the appropriate certificates, you need to configure your Wildfly installation to use it.
First step is to move the keystore file to a directory you can reference in configuration.
I like to put it in <code>standalone/configuration</code>.
Then you need to edit <code>standalone/configuration/standalone.xml</code> to enable SSL/HTTPS.</p>
</div>
<div class="paragraph">
<p>To the <code>security-realms</code> element add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;security-realm name=&quot;UndertowRealm&quot;&gt;
    &lt;server-identities&gt;
        &lt;ssl&gt;
            &lt;keystore path=&quot;keycloak.jks&quot; relative-to=&quot;jboss.server.config.dir&quot; keystore-password=&quot;secret&quot; /&gt;
        &lt;/ssl&gt;
    &lt;/server-identities&gt;
&lt;/security-realm&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Find the element <code>server name=&quot;default-server&quot;</code> (it&#x2019;s a child element of <code>subsystem xmlns=&quot;urn:jboss:domain:undertow:1.0&quot;</code>) and add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;https-listener name=&quot;https&quot; socket-binding=&quot;https&quot; security-realm=&quot;UndertowRealm&quot;/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the <a href="https://docs.jboss.org/author/display/WFLY8/Undertow+(web)+subsystem+configuration" target="_blank">Wildfly Undertow</a> documentation for more information on fine tuning the socket connections.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_enable_ssl_on_a_reverse_proxy">Enable SSL on a Reverse Proxy</h4>
<div class="paragraph">
<p>Follow the documentation for your web server to enable SSL and configure reverse proxy for Keycloak.
It is important that you make sure the web server sets the <code>X-Forwarded-For</code> and <code>X-Forwarded-Proto</code> headers on the requests made to Keycloak.
Next you need to enable <code>proxy-address-forwarding</code> on the Keycloak http connector.
Assuming that your reverse proxy doesn&#x2019;t use port 8443 for SSL you also need to configure what port http traffic is redirected to.</p>
</div>
<div class="sect4">
<h5 id="_configure_wildfly">Configure WildFly</h5>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open <code>standalone/configuration/standalone.xml</code> in your favorite editor.</p>
</li>
<li>
<p>First add <code>proxy-address-forwarding</code> and <code>redirect-socket</code> to the <code>http-listener</code> element:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:undertow:1.1&quot;&gt;
    ...
    &lt;http-listener name=&quot;default&quot; socket-binding=&quot;http&quot;
        proxy-address-forwarding=&quot;true&quot; redirect-socket=&quot;proxy-https&quot;/&gt;
    ...
&lt;/subsystem&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then add a new <code>socket-binding</code> element to the <code>socket-binding-group</code> element:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;socket-binding-group name=&quot;standard-sockets&quot; default-interface=&quot;public&quot;
    port-offset=&quot;${jboss.socket.binding.port-offset:0}&quot;&gt;
    ...
    &lt;socket-binding name=&quot;proxy-https&quot; port=&quot;443&quot;/&gt;
    ...
&lt;/socket-binding-group&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the <a href="https://docs.jboss.org/author/display/WFLY8/Undertow+(web)+subsystem+configuration" target="_blank">WildFly</a> documentation for more information.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keycloak_server_in_domain_mode">Keycloak server in Domain Mode</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In domain mode, you start the server with the &quot;domain&quot; command instead of the &quot;standalone&quot; command.
In this case, the Keycloak subsystem is defined in domain/configuration/domain.xml instead of standalone/configuration.standalone.xml.
Inside domain.xml, you will see more than one profile.
The Keycloak subsystem is defined for all initial profiles.</p>
</div>
<div class="paragraph">
<p>THe server is also added to server profiles.
By default two servers are started in the main-server-group which uses the full profile.</p>
</div>
<div class="paragraph">
<p>You need to make sure <code>domain/servers/SERVER NAME/configuration</code> is identical for all servers in a group.</p>
</div>
<div class="paragraph">
<p>To deploy custom providers and themes you should deploys these as modules and make sure the modules are available to all servers in the group.
See <a href="#_providers">Providers</a> and <a href="#_themes">Themes</a> sections for more information on how to do this.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installing_keycloak_server_as_root_context">Installing Keycloak Server as Root Context</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Keycloak server can be installed as the default web application.
In doing so, the server can be referenced at <code>http://mydomain.com/</code> instead of <code>http://mydomain.com/auth</code>.</p>
</div>
<div class="paragraph">
<p>To do this, add the <code>default-web-module</code> attribute in the Undertow subystem in standalone.xml.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;subsystem xmlns=&quot;urn:jboss:domain:undertow:2.0&quot;&gt;
    &lt;server name=&quot;default-server&quot;&gt;
        &lt;host name=&quot;default-host&quot; alias=&quot;localhost&quot; default-web-module=&quot;keycloak-server.war&quot;&gt;
            &lt;location name=&quot;/&quot; handler=&quot;welcome-content&quot;/&gt;
        &lt;/host&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>keycloak-server.war</code> is the runtime name of the Keycloak server application.
Note that the WAR file does not exist as a file.
If its name changes (ie. <code>keycloak-server.war</code>) in the future, find its new name from the Keycloak log entry with <code>runtime-name:</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you have run your server before altering the root context, your database will contain references to the old /auth context. Your clients may also have incorrect references.
To fix this on the server side, you will need to export your database to json, make corrections, and then import.
Client-side <code>keycloak.json</code> files will need to be updated manually as well.
</td>
</tr>
</table>
</div>
</div>
</div>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../topics/Overview.html" class="navigation navigation-prev " aria-label="Previous page: Overview"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../topics/providers.html" class="navigation navigation-next " aria-label="Next page: Providers and SPIs"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
