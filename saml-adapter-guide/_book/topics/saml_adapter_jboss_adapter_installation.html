<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Adapter Installation | Keycloak Reference Guide</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../topics/saml_adapter_required_per_war_configuration.html" />
    
    
    <link rel="prev" href="../topics/saml_adapter_jboss_adapter.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="3.1"
        data-chapter-title="Adapter Installation"
        data-filepath="topics/saml_adapter_jboss_adapter_installation.adoc"
        data-basepath=".."
        data-revision="Wed Apr 06 2016 14:01:57 GMT+0530 (IST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="topics/saml_adapter_overview.html">
            
                
                    <a href="../topics/saml_adapter_overview.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Overview
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="topics/saml_adapter-config.html">
            
                
                    <a href="../topics/saml_adapter-config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        General Adapter Config
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="topics/saml_adapter_sp_element.html">
            
                
                    <a href="../topics/saml_adapter_sp_element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        SP Element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="topics/saml_adapter_sp_keys.html">
            
                
                    <a href="../topics/saml_adapter_sp_keys.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        SP Keys and Key elements
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="topics/saml_adapter_keystore_element.html">
            
                
                    <a href="../topics/saml_adapter_keystore_element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.1.</b>
                        
                        KeyStore Element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="topics/saml_adapter_key_pems.html">
            
                
                    <a href="../topics/saml_adapter_key_pems.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.2.</b>
                        
                        Key PEMS
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="topics/saml_adapter_sp_principalname_mapping_element.html">
            
                
                    <a href="../topics/saml_adapter_sp_principalname_mapping_element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        SP PrincipalNameMapping element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="topics/saml_adapter_roleidentifiers_element.html">
            
                
                    <a href="../topics/saml_adapter_roleidentifiers_element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        RoleIdentifiers element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="topics/saml_adapter_idp_element.html">
            
                
                    <a href="../topics/saml_adapter_idp_element.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        IDP Element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="topics/saml_adapter_idp_singlesignonservice_subelement.html">
            
                
                    <a href="../topics/saml_adapter_idp_singlesignonservice_subelement.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        IDP SingleSignOnService sub element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="topics/saml_adapter_idp_singlelogoutservice_subelement.html">
            
                
                    <a href="../topics/saml_adapter_idp_singlelogoutservice_subelement.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        IDP SingleLogoutService sub element
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="topics/saml_adapter_idp_keys_subelement.html">
            
                
                    <a href="../topics/saml_adapter_idp_keys_subelement.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        IDP Keys subelement
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="topics/saml_adapter_jboss_adapter.html">
            
                
                    <a href="../topics/saml_adapter_jboss_adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        JBoss/Wildfly Adapter
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="3.1" data-path="topics/saml_adapter_jboss_adapter_installation.html">
            
                
                    <a href="../topics/saml_adapter_jboss_adapter_installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Adapter Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="topics/saml_adapter_required_per_war_configuration.html">
            
                
                    <a href="../topics/saml_adapter_required_per_war_configuration.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Required Per WAR Configuration
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="topics/saml_adapter_securing_wars.html">
            
                
                    <a href="../topics/saml_adapter_securing_wars.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Securing WARs via Keycloak SAML Subsystem
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="topics/saml_adapter_tomcat_adapter.html">
            
                
                    <a href="../topics/saml_adapter_tomcat_adapter.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Tomcat 6, 7 and 8 SAML adapters
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="topics/saml_adapter_tomcat_adapter_installation.html">
            
                
                    <a href="../topics/saml_adapter_tomcat_adapter_installation.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Adapter Installation
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="topics/saml_adapter_tomcat_adapter_per_war_config.html">
            
                
                    <a href="../topics/saml_adapter_tomcat_adapter_per_war_config.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        Required Per WAR Configuration
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Keycloak Reference Guide</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <div class="sect1">
<h2 id="_jboss_adapter_installation">Adapter Installation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SAML Adapters are no longer included with the appliance or war distribution.Each adapter is a separate download on the Keycloak download site.
They are also available as a maven artifact.</p>
</div>
<div class="paragraph">
<p>Install on Wildfly 9 or 10:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd $WILDFLY_HOME
$ unzip keycloak-saml-wildfly-adapter-dist.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install on JBoss EAP 6.x:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd $JBOSS_HOME
$ unzip keycloak-saml-eap6-adapter-dist.zip</code></pre>
</div>
</div>
<div class="paragraph">
<p>This zip file creates new JBoss Modules specific to the Wildfly Keycloak SAML Adapter within your Wildfly distro.</p>
</div>
<div class="paragraph">
<p>After adding the Keycloak modules, you must then enable the Keycloak SAML Subsystem within your app server&#x2019;s server configuration: <code>domain.xml</code> or <code>standalone.xml</code>.</p>
</div>
<div class="paragraph">
<p>There is a CLI script that will help you modify your server configuration.
Start the server and run the script  from the server&#x2019;s bin directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ cd $JBOSS_HOME/bin
$ jboss-cli.sh -c --file=adapter-install-saml.cli</code></pre>
</div>
</div>
<div class="paragraph">
<p>The script will add the extension, subsystem, and optional security-domain as described below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-title">server</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">&quot;urn:jboss:domain:1.4&quot;</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">extensions</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">extension</span> <span class="hljs-attribute">module</span>=<span class="hljs-value">&quot;org.keycloak.keycloak-saml-adapter-subsystem&quot;</span>/&gt;</span>
          ...
    <span class="hljs-tag">&lt;/<span class="hljs-title">extensions</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">profile</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-title">subsystem</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">&quot;urn:jboss:domain:keycloak-saml:1.1&quot;</span>/&gt;</span>
         ...
    <span class="hljs-tag">&lt;/<span class="hljs-title">profile</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The keycloak security domain should be used with EJBs and other components when you need the security context created in the secured web tier to be propagated to the EJBs (other EE component) you are invoking.
Otherwise this configuration is optional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-title">server</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">&quot;urn:jboss:domain:1.4&quot;</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-title">subsystem</span> <span class="hljs-attribute">xmlns</span>=<span class="hljs-value">&quot;urn:jboss:domain:security:1.2&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">security-domains</span>&gt;</span>
...
      <span class="hljs-tag">&lt;<span class="hljs-title">security-domain</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;keycloak&quot;</span>&gt;</span>
         <span class="hljs-tag">&lt;<span class="hljs-title">authentication</span>&gt;</span>
           <span class="hljs-tag">&lt;<span class="hljs-title">login-module</span> <span class="hljs-attribute">code</span>=<span class="hljs-value">&quot;org.keycloak.adapters.jboss.KeycloakLoginModule&quot;</span>
                         <span class="hljs-attribute">flag</span>=<span class="hljs-value">&quot;required&quot;</span>/&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-title">authentication</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-title">security-domain</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">security-domains</span>&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For example, if you have a JAX-RS service that is an EJB within your WEB-INF/classes directory, you&#x2019;ll want to annotate it with the @SecurityDomain annotation as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">import org.jboss.ejb3.annotation.SecurityDomain;
import org.jboss.resteasy.annotations.cache.NoCache;

import javax.annotation.security.RolesAllowed;
import javax.ejb.EJB;
import javax.ejb.Stateless;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;
import java.util.ArrayList;
import java.util.List;

@Path(&quot;customers&quot;)
@Stateless
@SecurityDomain(&quot;keycloak&quot;)
public class CustomerService {

    @EJB
    CustomerDB db;

    @GET
    @Produces(&quot;application/json&quot;)
    @NoCache
    @RolesAllowed(&quot;db_user&quot;)
    public List<span class="hljs-tag">&lt;<span class="hljs-title">String</span>&gt;</span> getCustomers() {
        return db.getCustomers();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We hope to improve our integration in the future so that you don&#x2019;t have to specify the @SecurityDomain annotation when you want to propagate a keycloak security context to the EJB tier.</p>
</div>
</div>
</div>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../topics/saml_adapter_jboss_adapter.html" class="navigation navigation-prev " aria-label="Previous page: JBoss/Wildfly Adapter"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../topics/saml_adapter_required_per_war_configuration.html" class="navigation navigation-next " aria-label="Next page: Required Per WAR Configuration"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
